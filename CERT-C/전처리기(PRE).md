전처리기 관련 C 시큐어 코딩 규칙
======

1. 매크로 함수의 모든 인자에 괄호를 사용하라   
(예시 코드)
```C
#include <stdio.h>
#define SQR(x) x*x

int main(){
    int n = SQR(2 + 1);
    printf("%d\n", n);
    
}
```
* 위 코드에서 SQR(2+1)은 9가 나오길 기대하고 호출한 매크로 함수이지만, 실제 과정은 다음과 같다.
* 매크로 함수는 코드가 그대로 복사되기 때문에 인수로 들어간 2 + 1이
  2 + 1 * 2 + 1이 되어 결과값이 5가 나온다.
* 이러한 상황을 방지하기 위해 모든 매크로 함수의 인자에는 괄호를 사용해야 한다.   
(적용 코드)
```C
#include <stdio.h>
#define SQR(x) (x)*(x)

int main(){
    int n = SQR(2 + 1);
    printf("%d\n", n);
}
```

<hr/>

2. 치환될 매크로의 최 외곽에도 괄호를 사용하라.
(예시 코드)
```C
#include <stdio.h>
#define DBL(x) (x)+(x)

int main(){
    int n = DBL(2) * DBL(2);
    printf("%d\n", n);
}
```
* 우리는 n의 결과가 4 * 4로 16이 나오길 기대했지만, 결과값은 8이 나온다.
* 그 이유는 다음과 같다.   
SQR(2) * SQR(2)는 (2)+(2)*(2)+(2) = 8이 되기 때문이다.  
* 이러한 상황을 방지하기 위해 치환될 매크로의 최 외곽에 항상 괄호를 사용해야 한다.    
(결과 코드)
```C
#include <stdio.h>
#define DBL(x) ((x)*(x))

int main(){
    int n = DBL(2) * DBL(2);
    printf("%d\n", n);
}
```

<hr/>

3. 매크로 상수의 값에는 괄호를 씌워줘라.
<hr/>

4. 매크로로는 타입 인코딩을 하지말고, typedef를 사용하라.
<hr/>

5. 여러 줄의 매크로에 대해서는 do-while로 묶어줘라.(swap.md 확인)
<hr/>

6. 매크로 안에서 단항 연산자와 같은 연산자를 사용하지 말아라.   
이는 미정의 동작이므로 사용하면 안된다.
<hr/>

7. 정말 특별한 경우가 아니라면 매크로의 사용은 지양하라. 
<hr/>

8. 헤더파일에는 반드시 Inclusion Guard를 사용하라.   
    헤더 파일에 있는 함수의 선언 및 정의, 구조체의 정의 등은 중복되면 안된다.   
    (예시 코드 - Point.h의 경우)
```C
#ifndef _POINT_H_
#define _POINT_H_

// 헤더파일 내용

#endif
```

<hr/>

9. 헤더파일에는 전역 변수를 정의하지 말아라.   
    즉, 헤더파일에는 전역 변수를 선언만 하고, 변수의 정의는 해당 헤더파일을 구현하는 파일에 하라.   
    (구조체의 경우에는 정의를 해도 메모리 상에 올라가지 않고, 컴파일러에게 정보만 전달하는 것이기 때문에 정의해도 된다.)   
    --> 따라서 메모리가 잡히는 정의는 헤더파일에 두면 안된다.

<hr/>

10. 인라인, 매크로 함수를 제외한 함수는 헤더파일에 정의하지 말아라.   
    (링킹 시점에 충돌이 발생하기 때문이다.)

<hr/>

11. 인라인, 매크로 함수는 반드시 헤더파일에 정의해라.   
    (인라인 함수는 호출된 곳이 모두 기계어로 치환되면, 해당 함수는 더이상 참조하지 않기 때문에 컴파일에서 제외된다.   매크로 함수도 인라인 함수와 같은 개념으로 처리된다.)

<hr/>

12. typedef, 구조체 정의부 등은 정보만 컴파일러에게 제공하는 것이므로 헤더파일에 작성해도 된다.
    
<hr/>